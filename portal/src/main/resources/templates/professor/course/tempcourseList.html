<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
			xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
			layout:decorate="~{layout/professor_layout}">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<th:block layout:fragment="professorContent">
	<div id="main">
		<div>
			<h2>강의 계획서 조회</h2>
		</div>
		<div class="card-body">
			<form name="searchForm" class="form-horizontal">
			<select id="type" name="type">
				<option value="course_year">개설연도</option>
				<option value="course_semester">개설학기</option>
				</select>
				<input type="number" name="keyword" id="keyword">
				<button class="btn rounded-pill btn-primary" type="submit">검색</button>
				
			</form>
			<table class="table">
				<thead>
					<tr>
						<th>년도</th>
						<th>학기</th>
						<th>이수단위</th>
						<th>이수구분</th>
						<th>강의명</th>
						<th>제출여부</th>
						<th>승인여부</th>
						<th>상세보기</th>
						<th>제출하기</th>
						
					</tr>
				</thead>
				<tbody>
				 	
					<tr th:each="item:${tempcourseList}">
							<td th:text="${item.courseYear}"></td>
							<td th:text="${item.courseSemester}"></td>
							<!-- <td th:text="${item.courseCredit}"></td> -->
							<td th:if="${item.courseCredit == 1}">1학점</td>
							<td th:if="${item.courseCredit == 2}">2학점</td>
							<td th:if="${item.courseCredit == 3}">3학점</td>
							<td th:if="${item.courseCredit == 4}">4학점</td>
							<td th:if="${item.courseCredit == 5}">5학점</td>
							<!-- <td th:text="${item.courseSortation}"></td> -->
							<td th:if="${item.courseSortation == 'L01'}">교양필수</td>
							<td th:if="${item.courseSortation == 'L02'}">교양</td>
							<td th:if="${item.courseSortation == 'M01'}">전공필수</td>
							<td th:if="${item.courseSortation == 'M02'}">전공</td>
							<td th:text="${item.courseName}">
							</td>
							<td th:if="${item.submitYes == 'SUB'}" data-code="SUB" id="submitYes">제출</td>
							<td th:if="${item.submitYes == 'UNSUB'}" data-code="SUB" id="submitYes">미제출</td>
							<td th:if="${item.okayYes == 'A00'}" data-back="A01" id="okayYes">승인</td>
							<td th:if="${item.okayYes == 'A01'}" data-back="A01" id="okayYes">심사대기</td>
							<td th:if="${item.okayYes == null}" data-back="A01" id="okayYes"></td>
							<td>
							<a th:href="|/professor/getTemp/${item.courseCode}|"><button th:text="상세보기" th:data-courseName="${item.courseCode}" class="btn btn-primary"></button></a>
							</td>
							<td><button name="button1" class="btn btn-danger moddd" th:data-course="${item.courseCode}" >제출하기</button></td>
						</tr>
						
				</tbody>
			</table>
			
			<button class="btn rounded-pill btn-primary" onclick="tempInsert()">등록</button>
			
		</div>
		</div>
		<script th:inline="javascript">
		
		/* $(function() {
			goPage(pageNum);
			tempInsert();
			getTemp();
		}) */
		
		/* function goPage(pageNum){
			searchFrm.pageNum.value = pageNum;
			searchFrm.submit();
		} */
		function tempInsert(){
			location.href="tempInsert";
		}
		function getTemp(){
			location.href="getTemp";
		}
		/* $(function(){
			$("#button1").on("click", tempInfo)
			function tempInfo(){
				var code = $(this).data("code")
				alert(code);
				location.href="getTemp/${code}";
			}
		}) */
		

		$(".moddd").on("click", function () {
			if (window.confirm("정말로 제출하시겠습니까?")) {
				let submitYes = $(this).closest("tr").find("#submitYes").data("code")
				let okayYes = $(this).closest("tr").find("#okayYes").data("back")
				let courseCode = $(this).data("course")
				$.ajax({
					url : `/professor/tempcourseList/submitTemp`,
					method : "post",
					dataType : "json",
					data : { 
						
					"submitYes" : 	submitYes,
					"okayYes" :	okayYes,
					"courseCode" :	 courseCode					
					},
					dataType : "json",
					success : function(result) {
						
						 
						alert('제출되었습니다')
						location.reload();
					} 
				});
			}
		})

		</script>
	</th:block>
</body>
</html>